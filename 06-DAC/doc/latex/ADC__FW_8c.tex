\hypertarget{ADC__FW_8c}{}\doxysection{source/\+ADC\+\_\+\+FW.c File Reference}
\label{ADC__FW_8c}\index{source/ADC\_FW.c@{source/ADC\_FW.c}}


\+: Firmware functions ADC  


{\ttfamily \#include \char`\"{}Aplication.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{ADC__FW_8c_a4b7af16ce55ad3fa7660520d52e8999a}{ADC\+\_\+\+Init}} (uint8\+\_\+t port, uint8\+\_\+t pin, uint8\+\_\+t ena)
\begin{DoxyCompactList}\small\item\em \+: Initialize ADC on a pin \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ADC__FW_8c_a0561a0fb200b6abf6276987d74bd87aa}{ADC\+\_\+\+Power}} (void)
\begin{DoxyCompactList}\small\item\em \+: Power ADC \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ADC__FW_8c_adedcf869c1c849cb9a55a16d470b8766}{ADC\+\_\+\+Enable}} (void)
\begin{DoxyCompactList}\small\item\em \+: Enable clock in ADC \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ADC__FW_8c_ae377cb1cf97e97c487dd99a815968966}{ADC\+\_\+\+Disable}} (void)
\begin{DoxyCompactList}\small\item\em \+: Disable clock in ADC \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ADC__FW_8c_a668d3a305991c257053a71cba9836bb0}{ADC0\+\_\+\+SEQA\+\_\+\+IRQHandler}} (void)
\begin{DoxyCompactList}\small\item\em \+: Interruption for ADC \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ADC__FW_8c_a260e06ce96c2e4deebccaedeb059dc0b}\label{ADC__FW_8c_a260e06ce96c2e4deebccaedeb059dc0b}} 
uint32\+\_\+t \mbox{\hyperlink{ADC__FW_8c_a260e06ce96c2e4deebccaedeb059dc0b}{tick}}
\begin{DoxyCompactList}\small\item\em Var for Sys\+Tick\+\_\+\+Handler. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ADC__FW_8c_a0a771ba01e69b26286484ddbe12988dc}\label{ADC__FW_8c_a0a771ba01e69b26286484ddbe12988dc}} 
uint32\+\_\+t \mbox{\hyperlink{ADC__FW_8c_a0a771ba01e69b26286484ddbe12988dc}{conv}}
\begin{DoxyCompactList}\small\item\em Var for ADC (not used) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\+: Firmware functions ADC 

\+: 12 bits convertion \begin{DoxyAuthor}{Author}
\+: Tobias Bavasso Piizzi 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
\+: 08/01/2021 
\end{DoxyDate}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{ADC__FW_8c_a668d3a305991c257053a71cba9836bb0}\label{ADC__FW_8c_a668d3a305991c257053a71cba9836bb0}} 
\index{ADC\_FW.c@{ADC\_FW.c}!ADC0\_SEQA\_IRQHandler@{ADC0\_SEQA\_IRQHandler}}
\index{ADC0\_SEQA\_IRQHandler@{ADC0\_SEQA\_IRQHandler}!ADC\_FW.c@{ADC\_FW.c}}
\doxysubsubsection{\texorpdfstring{ADC0\_SEQA\_IRQHandler()}{ADC0\_SEQA\_IRQHandler()}}
{\footnotesize\ttfamily \+:void ADC0\+\_\+\+SEQA\+\_\+\+IRQHandler (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



\+: Interruption for ADC 

\+: Interrupt when some channel finishes its conversion \begin{DoxyAuthor}{Author}
\+: Tobias Bavasso Piizzi 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
\+: 10/01/2021 
\end{DoxyDate}

\begin{DoxyParams}{Parameters}
{\em } & \mbox{[}in\mbox{]} void \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: void 
\end{DoxyReturn}
$<$ Clean flags

$<$ Read global data

$<$ Make an average

$<$ Start a new conversion

Definition at line 104 of file ADC\+\_\+\+FW.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{104                                 \{}
\DoxyCodeLine{105     \textcolor{keyword}{static} uint8\_t i    = 0;}
\DoxyCodeLine{106     \textcolor{keyword}{static} uint32\_t sum = 0;}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     (void) \_ADC\_SEQA\_GDAT;              }
\DoxyCodeLine{109 }
\DoxyCodeLine{110     sum += \mbox{\hyperlink{ADC__FW_8h_a4b7c68d9e83147063354832ef517ce31}{ADC\_SEQA\_GDAT}}-\/>\_RESULT;     }
\DoxyCodeLine{111     i++;}
\DoxyCodeLine{112     \textcolor{keywordflow}{if}( i == 0xFF )\{}
\DoxyCodeLine{113         \mbox{\hyperlink{ADC__FW_8c_a0a771ba01e69b26286484ddbe12988dc}{conv}}    = sum/i ;               }
\DoxyCodeLine{114         i       = 0;}
\DoxyCodeLine{115         sum     = 0;}
\DoxyCodeLine{116     \}}
\DoxyCodeLine{117     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_START  = 1;        }
\DoxyCodeLine{118 \}}

\end{DoxyCode}
\mbox{\Hypertarget{ADC__FW_8c_ae377cb1cf97e97c487dd99a815968966}\label{ADC__FW_8c_ae377cb1cf97e97c487dd99a815968966}} 
\index{ADC\_FW.c@{ADC\_FW.c}!ADC\_Disable@{ADC\_Disable}}
\index{ADC\_Disable@{ADC\_Disable}!ADC\_FW.c@{ADC\_FW.c}}
\doxysubsubsection{\texorpdfstring{ADC\_Disable()}{ADC\_Disable()}}
{\footnotesize\ttfamily \+:void ADC\+\_\+\+Disable (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



\+: Disable clock in ADC 

\+: \begin{DoxyAuthor}{Author}
\+: Tobias Bavasso Piizzi 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
\+: 08/01/2021 
\end{DoxyDate}

\begin{DoxyParams}{Parameters}
{\em } & \mbox{[}in\mbox{]} void \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: void 
\end{DoxyReturn}


Definition at line 90 of file ADC\+\_\+\+FW.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{90                        \{}
\DoxyCodeLine{91     SYSAHBCLKCTRL0\&= (\string~(1<<ADC\_SYSAHB));}
\DoxyCodeLine{92 \}}

\end{DoxyCode}
\mbox{\Hypertarget{ADC__FW_8c_adedcf869c1c849cb9a55a16d470b8766}\label{ADC__FW_8c_adedcf869c1c849cb9a55a16d470b8766}} 
\index{ADC\_FW.c@{ADC\_FW.c}!ADC\_Enable@{ADC\_Enable}}
\index{ADC\_Enable@{ADC\_Enable}!ADC\_FW.c@{ADC\_FW.c}}
\doxysubsubsection{\texorpdfstring{ADC\_Enable()}{ADC\_Enable()}}
{\footnotesize\ttfamily \+:void ADC\+\_\+\+Enable (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



\+: Enable clock in ADC 

\+: \begin{DoxyAuthor}{Author}
\+: Tobias Bavasso Piizzi 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
\+: 08/01/2021 
\end{DoxyDate}

\begin{DoxyParams}{Parameters}
{\em } & \mbox{[}in\mbox{]} void \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: void 
\end{DoxyReturn}


Definition at line 77 of file ADC\+\_\+\+FW.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{77                       \{}
\DoxyCodeLine{78     SYSAHBCLKCTRL0|= (1<<ADC\_SYSAHB);}
\DoxyCodeLine{79 \}}

\end{DoxyCode}
\mbox{\Hypertarget{ADC__FW_8c_a4b7af16ce55ad3fa7660520d52e8999a}\label{ADC__FW_8c_a4b7af16ce55ad3fa7660520d52e8999a}} 
\index{ADC\_FW.c@{ADC\_FW.c}!ADC\_Init@{ADC\_Init}}
\index{ADC\_Init@{ADC\_Init}!ADC\_FW.c@{ADC\_FW.c}}
\doxysubsubsection{\texorpdfstring{ADC\_Init()}{ADC\_Init()}}
{\footnotesize\ttfamily \+:void ADC\+\_\+\+Init (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{port,  }\item[{uint8\+\_\+t}]{pin,  }\item[{uint8\+\_\+t}]{ena }\end{DoxyParamCaption})}



\+: Initialize ADC on a pin 

\+: Continuos conversion of POTE in board \begin{DoxyAuthor}{Author}
\+: Tobias Bavasso Piizzi 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
\+: 08/01/2021 
\end{DoxyDate}

\begin{DoxyParams}{Parameters}
{\em } & \mbox{[}in\mbox{]} uint8\+\_\+t port\+: PORT0,PORT1 \\
\hline
{\em } & \mbox{[}in\mbox{]} uint8\+\_\+t pin\+: 0,31 \\
\hline
{\em } & \mbox{[}in\mbox{]} uint8\+\_\+t en\+: bit to enable in PINENABLE (page 143 UM) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: void 
\end{DoxyReturn}
$<$ Enable CLOCK in SYSAHB

$<$ Enable service interrupt

$<$ Interrupt after conversion finish

$<$ Enable Switch Matrix

$<$ Enable pin in SWN as Analog\+Input

$<$ Disable Switch Matrix

$<$ Power in SYSCON

$<$ Div = 0

$<$ Sync

$<$ OFF

$<$ OFF

$<$ Sample CH0

$<$ No hardware trigger

$<$ Positive trigger

$<$ Enable sync

$<$ Individual end of conversion

$<$ Start,enable set on the same line first time

Definition at line 23 of file ADC\+\_\+\+FW.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{23                                                       \{}
\DoxyCodeLine{24 }
\DoxyCodeLine{25     \mbox{\hyperlink{ADC__FW_8c_adedcf869c1c849cb9a55a16d470b8766}{ADC\_Enable}}();                     }
\DoxyCodeLine{26     ISER0|= \mbox{\hyperlink{ADC__FW_8h_aa8b1a103a46a96d151e3b64841df135d}{MASK\_ISE\_ADC\_SEQA}};         }
\DoxyCodeLine{27     ADC\_INTEN|= \mbox{\hyperlink{ADC__FW_8h_ad342cf648949d7fc3765f2a5fbc3e0f3}{MASK\_SEQA\_INTEN}};     }
\DoxyCodeLine{28     \mbox{\hyperlink{SwitchMatrix__FW_8c_a6bc0a5dfe96b74b30084854478b28afa}{SWM\_Enable}}();                     }
\DoxyCodeLine{29     \mbox{\hyperlink{SwitchMatrix__FW_8c_afb93272629fa17351ac351250714d27b}{SWM\_PinEnable}}(port, pin, ena);     }
\DoxyCodeLine{30     \mbox{\hyperlink{SwitchMatrix__FW_8c_a6ac2d7958a17b54a0a2d0d24bfa631d5}{SWM\_Disable}}();                       }
\DoxyCodeLine{31     \mbox{\hyperlink{ADC__FW_8c_a0561a0fb200b6abf6276987d74bd87aa}{ADC\_Power}}();                       }
\DoxyCodeLine{32 }
\DoxyCodeLine{33 }
\DoxyCodeLine{34 }
\DoxyCodeLine{35     \mbox{\hyperlink{ADC__FW_8h_a32af09f72946127b7d8f5f0d11de8d67}{ADC\_CTRL}}-\/>\_CLKDIV = 0x00;       }
\DoxyCodeLine{36     \mbox{\hyperlink{ADC__FW_8h_a32af09f72946127b7d8f5f0d11de8d67}{ADC\_CTRL}}-\/>\_ASYNCMODE = 0;       }
\DoxyCodeLine{37     \mbox{\hyperlink{ADC__FW_8h_a32af09f72946127b7d8f5f0d11de8d67}{ADC\_CTRL}}-\/>\_LPWRMODE = 0;        }
\DoxyCodeLine{38     \mbox{\hyperlink{ADC__FW_8h_a32af09f72946127b7d8f5f0d11de8d67}{ADC\_CTRL}}-\/>\_CALMODE = 0;         }
\DoxyCodeLine{39 }
\DoxyCodeLine{40     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_CHANNELS       = 0x01;     }
\DoxyCodeLine{41     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_TRIGGER        = 0x00;     }
\DoxyCodeLine{42     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_TRIGPOL        = 0x1;      }
\DoxyCodeLine{43     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_SYNCBYPASS         = 0x0;      }
\DoxyCodeLine{44     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_TSAMP          = 0x00;}
\DoxyCodeLine{45     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_START          = 0;}
\DoxyCodeLine{46     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_BURST          = 0;}
\DoxyCodeLine{47     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_SINGLESTEP         = 0x0;}
\DoxyCodeLine{48     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_LOWPRIO        = 0x0;}
\DoxyCodeLine{49     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_MODE           = 0;        }
\DoxyCodeLine{50     \mbox{\hyperlink{ADC__FW_8h_a3d2640db60bdaea88afdc79f18784200}{ADC\_SEQA\_CTRL}}-\/>\_SEQx\_ENA       = 0;}
\DoxyCodeLine{51     \_ADC\_SEQA\_CTRL |= ((0b100001) << 26);       }
\DoxyCodeLine{52 \}}

\end{DoxyCode}
\mbox{\Hypertarget{ADC__FW_8c_a0561a0fb200b6abf6276987d74bd87aa}\label{ADC__FW_8c_a0561a0fb200b6abf6276987d74bd87aa}} 
\index{ADC\_FW.c@{ADC\_FW.c}!ADC\_Power@{ADC\_Power}}
\index{ADC\_Power@{ADC\_Power}!ADC\_FW.c@{ADC\_FW.c}}
\doxysubsubsection{\texorpdfstring{ADC\_Power()}{ADC\_Power()}}
{\footnotesize\ttfamily \+:void ADC\+\_\+\+Power (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



\+: Power ADC 

\+: \begin{DoxyAuthor}{Author}
\+: Tobias Bavasso Piizzi 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
\+: 08/01/2021 
\end{DoxyDate}

\begin{DoxyParams}{Parameters}
{\em } & \mbox{[}in\mbox{]} void \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: void 
\end{DoxyReturn}


Definition at line 63 of file ADC\+\_\+\+FW.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{63                      \{}
\DoxyCodeLine{64     PDRUNCFG\&= (\string~(1 << MASK\_ADC\_SYSCON));}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \}}

\end{DoxyCode}
